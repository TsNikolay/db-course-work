(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{469:function(n,e,t){"use strict";t.r(e);var s=t(13),r=Object(s.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"реалізація-інформаціиного-та-програмного-забезпечення"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#реалізація-інформаціиного-та-програмного-забезпечення"}},[n._v("#")]),n._v(" Реалізація інформаційного та програмного забезпечення")]),n._v(" "),e("p",[n._v("В рамках проекту розробляється:")]),n._v(" "),e("ul",[e("li",[n._v("SQL-скрипт для створення на початкового наповнення бази даних")]),n._v(" "),e("li",[n._v("RESTfull сервіс для управління даними")])]),n._v(" "),e("h2",{attrs:{id:"sql-скрипт"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sql-скрипт"}},[n._v("#")]),n._v(" SQL-скрипт")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("\nSET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;\nSET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;\nSET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';\n\n-- -----------------------------------------------------\n-- Schema mydb\n-- -----------------------------------------------------\nDROP SCHEMA IF EXISTS `mydb` ;\n\n-- -----------------------------------------------------\n-- Schema mydb\n-- -----------------------------------------------------\nCREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;\nUSE `mydb` ;\n\n-- -----------------------------------------------------\n-- Table `mydb`.`answer`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `mydb`.`answer` ;\n\nCREATE TABLE IF NOT EXISTS `mydb`.`answer` (\n  `user_id` INT NOT NULL,\n  `text` TEXT NOT NULL,\n  `data` DATE NOT NULL,\n  `id` INT NOT NULL AUTO_INCREMENT,\n  `answer_id` INT NOT NULL,\n  PRIMARY KEY (`id`),\n  INDEX `fk_selectedOption_id_idx` (`answer_id` ASC) VISIBLE,\n  INDEX `fk_user_id_idx` (`user_id` ASC) VISIBLE,\n  CONSTRAINT `fk_selectedOption_id`\n    FOREIGN KEY (`answer_id`)\n    REFERENCES `mydb`.`selectedOption` (`id`)\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION,\n  CONSTRAINT `fk_user_id`\n    FOREIGN KEY (`user_id`)\n    REFERENCES `mydb`.`user` (`id`)\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION);\n\n\n-- -----------------------------------------------------\n-- Table `mydb`.`category`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `mydb`.`category` ;\n\nCREATE TABLE IF NOT EXISTS `mydb`.`category` (\n  `category_id` INT NOT NULL,\n  `name` VARCHAR(255) NOT NULL,\n  PRIMARY KEY (`category_id`));\n\n\n-- -----------------------------------------------------\n-- Table `mydb`.`option`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `mydb`.`option` ;\n\nCREATE TABLE IF NOT EXISTS `mydb`.`option` (\n  `type` TEXT(255) NOT NULL,\n  `text` TEXT(255) NOT NULL,\n  `id` INT NOT NULL AUTO_INCREMENT,\n  `question_id` INT NOT NULL,\n  PRIMARY KEY (`id`),\n  INDEX `fk_question_id_idx` (`question_id` ASC) VISIBLE,\n  CONSTRAINT `fk_question_id`\n    FOREIGN KEY (`question_id`)\n    REFERENCES `mydb`.`question` (`id`)\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION);\n\n\n-- -----------------------------------------------------\n-- Table `mydb`.`question`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `mydb`.`question` ;\n\nCREATE TABLE IF NOT EXISTS `mydb`.`question` (\n  `type` TEXT(255) NOT NULL,\n  `text` TEXT(255) NOT NULL,\n  `id` INT NOT NULL AUTO_INCREMENT,\n  `topic` TEXT(255) NOT NULL,\n  `quiz_id` INT NOT NULL,\n  PRIMARY KEY (`id`),\n  INDEX `fk_quiz_id_idx` (`quiz_id` ASC) VISIBLE,\n  CONSTRAINT `fk_quiz_id`\n    FOREIGN KEY (`quiz_id`)\n    REFERENCES `mydb`.`quiz` (`id`)\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION);\n\n\n-- -----------------------------------------------------\n-- Table `mydb`.`quiz`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `mydb`.`quiz` ;\n\nCREATE TABLE IF NOT EXISTS `mydb`.`quiz` (\n  `type` TEXT(255) NOT NULL,\n  `text` TEXT(255) NOT NULL,\n  `id` INT NOT NULL AUTO_INCREMENT,\n  `topic` TEXT(255) NOT NULL,\n  `date` DATETIME NOT NULL,\n  `creator_id` INT NOT NULL,\n  PRIMARY KEY (`id`),\n  INDEX `fk_creator_id_idx` (`creator_id` ASC) VISIBLE,\n  CONSTRAINT `fk_creator_id`\n    FOREIGN KEY (`creator_id`)\n    REFERENCES `mydb`.`user` (`id`)\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION);\n\n\n-- -----------------------------------------------------\n-- Table `mydb`.`selectedOption`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `mydb`.`selectedOption` ;\n\nCREATE TABLE IF NOT EXISTS `mydb`.`selectedOption` (\n  `id` INT NOT NULL AUTO_INCREMENT,\n  `option_id` INT NOT NULL,\n  PRIMARY KEY (`id`),\n  INDEX `fk_option_id_idx` (`option_id` ASC) VISIBLE,\n  CONSTRAINT `fk_option_id`\n    FOREIGN KEY (`option_id`)\n    REFERENCES `mydb`.`option` (`id`)\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION);\n\n\n-- -----------------------------------------------------\n-- Table `mydb`.`user`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `mydb`.`user` ;\n\nCREATE TABLE IF NOT EXISTS `mydb`.`user` (\n  `username` VARCHAR(16) NOT NULL,\n  `mail` VARCHAR(255) NOT NULL,\n  `id` INT NOT NULL AUTO_INCREMENT,\n  PRIMARY KEY (`id`));\n\n\nSET SQL_MODE=@OLD_SQL_MODE;\nSET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;\nSET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;\n\n")])])]),e("h2",{attrs:{id:"rest-full-сервіс-для-управління-даними"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rest-full-сервіс-для-управління-даними"}},[n._v("#")]),n._v(" REST-full сервіс для управління даними")]),n._v(" "),e("h3",{attrs:{id:"фаил-підключення-до-бази-данних"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#фаил-підключення-до-бази-данних"}},[n._v("#")]),n._v(" Файл підключення до бази данних")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('const mysql = require("mysql2");\n\nconst connection = mysql.createConnection({\n  host: "localhost",\n  user: "root",\n  password: "ubuntu",\n  database: "mydb",\n});\n\nmodule.exports = connection;\n')])])]),e("h3",{attrs:{id:"основнии-фаил-серверу"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#основнии-фаил-серверу"}},[n._v("#")]),n._v(" Основний файл серверу")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('const express = require("express");\nconst bodyParser = require("body-parser");\nconst connection = require("./db");\n\nconst app = express();\nconst port = process.env.PORT || 8888;\n\nconnection.connect((error) => {\n    if(error){\n        console.log("Error caught")\n    } else {\n        console.log("Connection successful")\n    }\n})\n\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(bodyParser.json());\n\nconst routes = require("./routes");\nroutes(app);\n\napp.listen(port)\n')])])]),e("h3",{attrs:{id:"фаил-роутера"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#фаил-роутера"}},[n._v("#")]),n._v(" Файл роутера")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('module.exports = (app) => {\n  const option = require("./controllers");\n\n  app.route("/api/selectedOptions").get(option.getAll);\n  app.route("/api/selectedOption/:id").get(option.get);\n  app.route("/api/selectedOptions/add").post(option.add);\n  app.route("/api/selectedOption/patch").patch(option.update);\n  app.route("/api/selectedOption/:id").delete(option.delete);\n};\n')])])]),e("h3",{attrs:{id:"фаил-обробників-запитів"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#фаил-обробників-запитів"}},[n._v("#")]),n._v(" Файл обробників запитів")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('const database = require("./db");\n\nexports.getAll = (req, res) => {\n  const request = `SELECT * FROM selectedOption`;\n  database.query(request, (err, result) => {\n    if (err) return res.status(500).json(err);\n    if (result.length === 0) return res.sendStatus(404);\n    res.status(200).json(result);\n  });\n};\n\nexports.get = (req, res) => {\n  const request = `SELECT * FROM selectedOption WHERE id=${req.params.id}`;\n  database.query(request, (err, result) => {\n    if (err) return res.status(500).json(err);\n    if (result.length === 0) return res.sendStatus(404);\n    res.status(200).json(result[0]);\n  });\n};\n\nexports.add = (req, res) => {\n  const { id , option_id} = req.body;\n  if (!(id && option_id))\n    return res\n      .status(400)\n      .json("OptionID, ID are required");\n  database.query(`SELECT * FROM selectedOption WHERE id=${id}`, (err, result) => {\n    if (err) return res.status(500).json(err);\n    if (result.length !== 0)\n      return res.status(404).json(`Option with such id ${id} exists`);\n    const request =\n      `INSERT INTO selectedOption(id, option_id) VALUES(${id}, ${option_id})`;\n    database.query(request, (err, result) => {\n       if (err) return res.status(500).json(err);\n      res.status(201).json(`Option with such id ${id} added`);\n    });\n  });\n};\n\nexports.update = (req, res) => {\n  const { id, option_id } = req.body;\n  if (!(id && option_id)) return res.status(400).json( "Required id and option_id" );\n  database.query(`SELECT * FROM selectedOption WHERE option_id=${option_id}`, (err, result) => {\n    if (err) return res.status(500).json(err);\n    if (result.length === 0) return res.status(404).json("No option with such option_id");\n    \n    const request = `UPDATE selectedOption SET id=${id} WHERE option_id=${option_id}`;\n    database.query(request, (err, result) => {\n      if (err) return res.status(500).json(err);\n      res.status(200).json(`Option with option_id ${option_id} updated`); \n    });\n  });\n};\n\nexports.delete = (req, res) => {\n  const { id } = req.params;\n  if (!id) return res.status(400).json("Id required");\n  const request = `DELETE FROM selectedOption WHERE id=${id}`;\n  database.query(`SELECT * FROM selectedOption WHERE id=${id}`, (err, result) => {\n    if (err) return res.status(500).json(err);\n    if (result.length === 0)\n      return res.status(404).json("No option with such id");\n    database.query(request, (err, result) => {\n      if (err) return res.status(500).json(err);\n      res.status(200).json(`Option with id ${id} was deleted`);\n    });\n  });\n};\n')])])])])}),[],!1,null,null,null);e.default=r.exports}}]);